{
  "kind": "tm:ltm:rule:rulestate",
  "name": "H2C_vulnerability_removal",
  "partition": "www-qa",
  "fullPath": "/www-qa/H2C_vulnerability_removal",
  "generation": 1,
  "selfLink": "https://localhost/mgmt/tm/ltm/rule/~www-qa~H2C_vulnerability_removal?ver=16.1.4.1",
  "apiAnonymous": "when HTTP_REQUEST {\n\nif { ( [string tolower [HTTP::header value Upgrade]] contains \"h2c\" ) } {\n\n   set url [HTTP::header Host]\n   set uri [HTTP::uri]\n   set vip [IP::local_addr]:[TCP::local_port]\n   set client [IP::client_addr]\n\n   log local0. \"Client: $client -> VIP:$vip -> URL:$url -> URI:$uri -> Upgrade header: [HTTP::header value Upgrade] \"\n   HTTP::header remove upgrade\n   HTTP::header remove connection\n\n  }\n}"
}