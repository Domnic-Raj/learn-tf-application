{
  "kind": "tm:ltm:rule:rulestate",
  "name": "Prevent_Clickjacking_attacks",
  "partition": "www-qa",
  "fullPath": "/www-qa/Prevent_Clickjacking_attacks",
  "generation": 1,
  "selfLink": "https://localhost/mgmt/tm/ltm/rule/~www-qa~Prevent_Clickjacking_attacks?ver=16.1.4.1",
  "apiAnonymous": "when HTTP_REQUEST {\n           set check_response 0\n            switch -glob [HTTP::header \"Referer\"] {\n                        \"*.tdameritrade.com*\" -\n                        \"*.ameritrade.com*\" -\n                        \"*.advisorclient.com*\" -\n                        \"*.markitondemand.com*\" -\n                        \"*.wsodqa.com*\" -\n                        \"*.wallst.com*\" -\n                        \"*.advisorservices.com*\" -\n                        \"*.tdainstitutional.com*\" -\n                        \"\"\n                        {\n                                    # Allow Request to go through\n                                    return\n                        }\n                        default {\n                                    set check_response 1\n                        }\n            }\n}\n\nwhen HTTP_RESPONSE {\n\n            if {$check_response==1}{            \n                        #X-Frame-Options\n                        HTTP::header insert \"X-Frame-Options\" \"SAMEORIGIN\"\n            }\n\n            #Content-Security-Policy\n            HTTP::header insert \"Content-Security-Policy\" \"frame-ancestors 'self' https://*.tdameritrade.com https://*.ameritrade.com https://*.advisorclient.com https://*.tdainstitutional.com https://*.advisorservices.com https://*.markitondemand.com https://*.wsodqa.com https://*.wallst.com\"\n            #X-Content-Security-Policy for IE\n            HTTP::header insert \"X-Content-Security-Policy\" \"frame-ancestors 'self'  https://*.tdameritrade.com https://*.ameritrade.com https://*.advisorclient.com https://*.tdainstitutional.com https://*.advisorservices.com https://*.markitondemand.com https://*.wsodqa.com https://*.wallst.com\"\n}"
}